#!/usr/bin/env ruby
# -*- coding: UTF-8 -*-

require 'yaml'
require "fileutils"
require "redcarpet"
require "pars"

include Pars

if Pars.isParsDir? then

	$default_settings = {
		"title" => "Title of site",
		"description" => "Yet another static website"
	}
	
	$user_settings = File.open(".pars.yml") { |file| YAML.load(file) } 

	$settings = {
			"title" => if $user_settings then if $user_settings["title"] != nil then $user_settings["title"] else $default_settings["title"] end else $default_settings["title"] end,
			"description" => if $user_settings then if $user_settings["description"] != nil then $user_settings["description"] else $default_settings["description"] end else $default_settings["description"] end
		} 

		
	if anyPost? then

		header = File.open("view/header.html").read
		footer = File.open("view/footer.html").read

		File.delete('index.html') if File.exist?('index.html')

		index = File.open("index.html","a")

		generate

		
		index.close
	else

		puts "posts not exists"
	end

else
	puts "Here is not a pars project."
end
